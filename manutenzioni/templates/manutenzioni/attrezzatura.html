{% extends 'core/base.html' %}
{% load crispy_forms_tags %}
{% block title %}{{ block.super }} | Attrezzatura {% endblock %}

{% block sidenav %}
{% include "core/partials/_sidenav_human_resources.html" %}
{% endblock %}

{% block content %}


<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>      
        <li class="breadcrumb-item"><a href="{% url 'manutenzioni:dashboard_manutenzioni' %}">Dashboard manutenzioni</a></li>        

        {% if form.instance.id  %}
            <li class="breadcrumb-item active" aria-current="page">Modifica {{ attrezzatura.codice_attrezzatura }}</li>
        {% else %}
            <li class="breadcrumb-item active" aria-current="page">Aggiungi Attrezzatura</li>
        {% endif %}             
        
        
    </ol>
</nav>

    <div class="container">
        {% if form.instance.id  %}
            <h3>Modifica {{ attrezzatura.codice_attrezzatura }}</h3>
        {% else %}
            <h3> Aggiungi Attrezzatura</h3>
        {% endif %}
        
        
        <hr>
        
        
        
        
        <br>


        <form method="post">
            {% csrf_token %}

            

            <div class="row">
                <div class="col-3">
                    {{ form.codice_attrezzatura|as_crispy_field }}
                </div>
                <div class="col-3">
                    {{ form.descrizione|as_crispy_field }}
                </div>
                <div class="col-3">
                    {{ form.modello|as_crispy_field }}
                </div>
                <div class="col-3">
                    {{ form.serie_matricola|as_crispy_field }}
                </div>
                
                
            </div>
            <div class="row">
                <div class="col-2">
                    {{ form.is_dismesso|as_crispy_field }}
                </div>
                <div class="col-2">
                    {{ form.data_dismissione|as_crispy_field }}
                </div>
               


            </div>
            <div class="row">
                <div class="col-2">
                    {{ form.is_taratura|as_crispy_field }}
                </div>
                <div class="col-2">
                    {{ form.periodo_taratura|as_crispy_field }}
                </div>
                <div class="col-6">
                    {{ form.note|as_crispy_field }}
                </div>
                <div class="col-2">
                    {{ form.created_by.as_hidden }}
                </div>


            </div>
            

            
            <input type="submit" name="salva_esci" class="btn btn-success mb-2 me-1" value="Salva ed Esci">
            <input type="submit" name="salva_continua" class="btn btn-success mb-2 me-1" value="Salva e continua">
        </form>
        <hr>
        


<!-- Tabella Manutenzioni Ordinarie -->
<div class="row">
    <div class="col-4">
      <h5>Manutenzioni Ordinarie</h5>
                
    </div>
    {% if form.instance.id  %}
    <div class="col-4 text-end">
      
      <a href="#" class="btn btn-sm btn-success"><i class="bi bi-file-earmark-plus"></i> Aggiungi Manutenzione</a>

    </div>
  </div>
    <div class="table-container">
        <table class="table table-bordered table-striped mt-2">
            <thead>
            <tr>
                <th>Data</th>   
                <th>Descrizione</th>
                <th>Azione</th>
                
            </tr>
            </thead>
            <tbody>
            {% for man_ord in elenco_man_ord %}
            <tr>        
                
                <td><a href="#">{{ man_ord.data_manutenzione }}</a></td>
                <td>{{ man_ord.descrizione }}</td>
                
                <td class="text-center"><a href="#" class="btn btn-sm btn-outline-danger confirm-delete" title="Delete" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal" id="deleteButton{{man_ord.pk}}"><i class="bi bi-trash"></i>Elimina</a></td>
            </tr>  
            {% endfor %}
            </tbody>
        </table>
    </div>
  {% endif %}
</div>

        
    



  



{% endblock %}

{% block extra_scripts %}
<script>
    $(document).ready(function() {
      // Ottieni i riferimenti ai campi
      var booleanField = $('#id_is_taratura');
      var secondField = $('#id_periodo_taratura');
    
      // Inizializza lo stato del secondo campo
      updateRequiredAttribute();
    
      // Aggiorna lo stato del secondo campo quando il campo booleano cambia
      booleanField.change(function() {
        updateRequiredAttribute();
      });
    
      // Funzione per aggiornare lo stato del secondo campo
      function updateRequiredAttribute() {
        if (booleanField.is(':checked')) {
          secondField.attr('required', 'required');
        } else {
          secondField.removeAttr('required');
        }
      }
    });
    </script>
    
{% endblock %} 